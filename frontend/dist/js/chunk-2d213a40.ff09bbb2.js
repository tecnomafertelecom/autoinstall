(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d213a40"],{ae17:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Page",[a("b-form",[a("b-form-row",[a("b-form-group",{staticClass:"col-md-auto",attrs:{label:"Data Início"}},[a("b-select",{attrs:{plain:"",size:"md"},on:{change:t.changeTime},model:{value:t.period,callback:function(e){t.period=e},expression:"period"}},[a("b-form-select-option",{attrs:{value:""}},[t._v("Atual")]),t._v(" "),a("b-form-select-option",{attrs:{value:"7"}},[t._v("7 dias")]),t._v(" "),a("b-form-select-option",{attrs:{value:"15"}},[t._v("15 dias")]),t._v(" "),a("b-form-select-option",{attrs:{value:"30"}},[t._v("30 dias")]),t._v(" "),a("b-form-select-option",{attrs:{value:"60"}},[t._v("60 dias")])],1)],1),t._v(" "),a("b-form-group",{staticClass:"col-md-auto",attrs:{label:"Data Início"}},[a("date-picker",{staticClass:"mt-1",attrs:{format:"DD-MM-YYYY HH:mm:ss",type:"datetime"},model:{value:t.time1,callback:function(e){t.time1=e},expression:"time1"}})],1),t._v(" "),a("b-form-group",{staticClass:"col-md-auto",attrs:{label:"Data Final"}},[a("date-picker",{staticClass:"mt-1",attrs:{format:"DD-MM-YYYY HH:mm:ss",type:"datetime"},model:{value:t.time2,callback:function(e){t.time2=e},expression:"time2"}})],1),t._v(" "),a("b-form-group",{staticClass:"col-md-auto",attrs:{label:"Agentes"}},[a("b-select",{attrs:{plain:"",multiple:"",options:t.agents,size:"md"},model:{value:t.agent,callback:function(e){t.agent=e},expression:"agent"}})],1)],1),t._v(" "),a("b-form-row",[a("ladda-btn",{staticClass:"btn btn-success",attrs:{loading:t.loading,"data-style":"expand-left"},nativeOn:{click:function(e){return t.getPerformance.apply(null,arguments)}}},[t._v("Visualizar")])],1)],1)],1),t._v(" "),a("Page",{attrs:{hidden:0==t.table.length}},[a("Table",{attrs:{tableData:t.table,filename:t.fileName,header:t.header,tablefooter:t.footer,legend:t.legend}})],1)],1)},n=[],s=(a("99af"),a("7db0"),a("a15b"),a("d81d"),a("14d9"),a("13d5"),a("b0c0"),a("b680"),a("d3b7"),a("e25e"),a("3ca3"),a("159b"),a("ddb0"),a("9861"),a("88a7"),a("271a"),a("5494"),a("9973")),i=a("0748"),r=a("41dc"),u=(a("29ac"),a("ec45")),l=a("c1df"),c=a.n(l),m=a("2ef0"),d=a.n(m),p=a("bc3a"),h=a.n(p),f={name:"perfomance",components:{Page:s["a"],DatePicker:u["default"],LaddaBtn:r["a"],Table:i["a"]},metaInfo:{title:"Relatório Desempenho de Agente"},data:function(){return{time1:c()().hour(0).minute(0).second(0).toDate(),time2:c()().hour(23).minute(59).second(59).toDate(),period:"",agents:[],agent:[],entry:"",queueLog:"",table:[],loading:!1,header:[],legend:[],fileName:"",totalPause:[],footer:[]}},mounted:function(){this.$store.commit("setTitle","Relatório Desempenho de Agente"),this.loadAgents()},methods:{updateHeader:function(){this.header=[],this.header.push("<h4>Relatório Desempenho de Agente</h4>"),this.header.push("Período ".concat(c()(this.time1).format("DD/MM/YYYY")," à ").concat(c()(this.time2).format("DD/MM/YYYY")," / Hora à ").concat(c()(this.time1).format("HH:mm:ss")," até ").concat(c()(this.time2).format("HH:mm:ss"))),this.header.push(" "),this.fileName="Rel_agente_desempenho ".concat(c()().format("DD_MM_YYYY_HH_mm_ss")),this.legend=["<h5>Legenda:</h5>","<b>TTC</b> - Tempo total de chamada;","<b>TMC</b> - Tempo médio de chamada;","<b>TME</b> - tempo médio de espera;","<b>Enc User</b> - Finalizadas pelo cliente;","<b>Enc Oper</b> - Finalizadas pelo operador;","<b>Tempo Login</b> - Tempo total de login do operador;","<b>Tempo Pausa</b> - Tempo total de pausas do operador;","<b>Emitido em:</b> ".concat(c()().format("DD/MM/YYYY HH:mm:ss"))]},changeTime:function(){this.time1=""===this.period?c()().hour(0).minute(0).second(0).toDate():c()().add(-1*this.period,"d").hour(0).minute(0).second(0).toDate(),this.time2=c()().hour(23).minute(59).second(59).toDate()},loadAgents:function(){var t=this;h.a.post("".concat(location.origin,"/reportsbackend/agents_callcenter.php")).then((function(e){t.agents=[{text:"Todos",value:""}],e.data.forEach((function(e){t.agents.push({text:e.name,value:e.id})}))})).catch((function(t){return console.log(t)}))},getPerformance:function(){var t=this;this.loading=!0,this.table=[];var e=new URLSearchParams;e.append("time1",c()(this.time1).format("YYYY-MM-DD HH:mm:ss")),e.append("time2",c()(this.time2).format("YYYY-MM-DD HH:mm:ss")),e.append("agent",this.agent.join(",")),h.a.post("".concat(location.origin,"/reportsbackend/report_perfomance_queue_log.php"),e).then((function(e){t.queueLog=e.data})).catch((function(t){return console.log(t)})),h.a.post("".concat(location.origin,"/reportsbackend/report_total_pause_agents.php"),e).then((function(e){t.totalPause=e.data})).catch((function(t){return console.log(t)})),h.a.post("".concat(location.origin,"/reportsbackend/report_perfomance_call_entry.php"),e).then((function(e){0===e.data.length&&t.$bvToast.toast("Nenhum registro encontrado",{title:"Tecnomafer Report",autoHideDelay:5e3,appendToast:!0,toastClass:"bs4-toast bg-danger"}),t.entry=e.data,t.mountTable(),t.updateHeader()})).catch((function(t){return console.log(t)})).finally((function(e){t.loading=!1}))},formatTime:function(t){var e=t.toFixed(0),a=Math.floor(e/3600),o=Math.floor((e-3600*a)/60),n=e-3600*a-60*o;return a<10&&(a="0"+a),o<10&&(o="0"+o),n<10&&(n="0"+n),a+":"+o+":"+n},mountTable:function(){var t=this,e=[];this.entry.forEach((function(a){var o=t.queueLog.find((function(t){return t.callid===a.id})),n=o?o.event:"COMPLETEAGENT";e.push({agent:a.Agente,id:a.id,duration:parseInt(a.Duration),durationWait:parseInt(a.DurationWait),durationPause:0,status:n})})),this.totalPause.forEach((function(t){e.push({agent:t.Agente,id:t.total+100,duration:0,durationWait:0,durationPause:parseInt(t.total),status:"Pausa"})})),this.table=d.a.chain(e).groupBy("agent").map((function(a,o){return{Agente:o,TTC:t.formatTime(d.a.sumBy(a,"duration")),TMC:t.formatTime(d.a.sumBy(a,"duration")/e.length),TME:t.formatTime(d.a.sumBy(a,"durationWait")/e.length),"Enc User":e.reduce((function(t,e){return"COMPLETECALLER"===e.status&&e.agent===o&&(t+=1),t}),0),"Enc Oper":e.reduce((function(t,e){return"COMPLETEAGENT"===e.status&&e.agent===o&&(t+=1),t}),0),"Tempo Login":t.formatTime(d.a.sumBy(a,"durationWait")+d.a.sumBy(a,"duration")+d.a.sumBy(a,"durationPause")),"Tempo Pausa":t.formatTime(d.a.sumBy(a,"durationPause"))}})).value();var a="00:00:00",o="00:00:00",n="00:00:00",s=0,i=0,r="00:00:00",u="00:00:00";this.table.forEach((function(e){a=t.sumTotalHour(a,String(Object.values(e)[1])),o=t.sumTotalHour(o,String(Object.values(e)[2])),n=t.sumTotalHour(n,String(Object.values(e)[3])),s+=parseInt(Object.values(e)[4]),i+=parseInt(Object.values(e)[5]),r=t.sumTotalHour(r,String(Object.values(e)[6])),u=t.sumTotalHour(u,String(Object.values(e)[7]))})),this.footer=[],this.footer.push("Total"),this.footer.push(a),this.footer.push(o),this.footer.push(n),this.footer.push(s),this.footer.push(i),this.footer.push(r),this.footer.push(u)},sumTotalHour:function(t,e){var a=t.split(":"),o=e.split(":"),n=parseInt(a[0]),s=parseInt(a[1]),i=parseInt(a[2]),r=parseInt(o[0]),u=parseInt(o[1]),l=parseInt(o[2]),c=60*(n+r)*60,m=60*(s+u),d=i+l;return this.formatTime(c+m+d)}}},b=f,g=a("2877"),v=Object(g["a"])(b,o,n,!1,null,null,null);e["default"]=v.exports}}]);
//# sourceMappingURL=chunk-2d213a40.ff09bbb2.js.map